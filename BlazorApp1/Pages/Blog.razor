@page "/blog"

@implements IDisposable

<PageTitle>Blog</PageTitle>

<h1>Blog</h1>

<p role="status">Bem-Vindo(a) ao meu blog! Você está aqui há @Time segundos</p>

@code {
    DateTime InitialTime = DateTime.Now;
    string Time;
    
    public void Dispose()
    {
        timer?.Dispose();
    }

    Timer timer;
    protected override void OnInitialized()
    {
        timer = new Timer(async _ => 
        {
            Time = await CalculateTime();        
            await InvokeAsync(StateHasChanged);
        }, null, 0, 1000);
    }

    private async Task<string> CalculateTime()
    {
        double seconds = Math.Truncate((DateTime.Now - InitialTime).TotalSeconds);
        var result = await seconds.ToString();
        return result;
    }
}